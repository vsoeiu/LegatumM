<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Legatum Music System - La plataforma definitiva de busqueda musical.">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="author" content="Legatum Dev Team">
    <title>Legatum - Busqueda Musical Enterprise</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600;800;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        /* ==========================================================================
           1. SISTEMA DE DISENO "DEEP SPACE TITANIUM" + IMPERIAL GOLD
           ========================================================================== */
        :root {
            /* --- Paleta de Fondo --- */
            --bg-void: #050505;         
            --bg-nebula: #1a0505;       
            --bg-overlay: rgba(0,0,0,0.8);
            
            /* --- Superficies de Vidrio (Glassmorphism 4.0) --- */
            --glass-surface: rgba(20, 10, 10, 0.65);
            --glass-surface-hover: rgba(35, 15, 15, 0.8);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            --glass-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
            
            /* --- Acentos de Neon (Identidad de Marca) --- */
            --neon-primary: #ff1a1a;    
            --neon-secondary: #800000;  
            --neon-glow: 0 0 25px rgba(255, 26, 26, 0.5);
            --neon-text-glow: 0 0 10px rgba(255, 255, 255, 0.3);

            /* --- Acentos Dorados (Estilo Imperial) --- */
            --gold-dark: #9F7F3C;
            --gold-main: #D4AF37;
            --gold-light: #FADD75;
            
            /* --- Tipografia --- */
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-tertiary: #888888;
            
            /* --- Estados del Sistema --- */
            --state-success: #1DB954;   
            --state-error: #ff3333;     
            --state-warning: #ffcc00;   
            --state-info: #3399ff;      
            
            /* --- Dimensiones y Fisicas --- */
            --radius-xl: 40px;
            --radius-lg: 30px;
            --radius-md: 20px;
            --radius-sm: 12px;
            --anim-fast: 0.2s cubic-bezier(0.2, 0, 0, 1);
            --anim-smooth: 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            --anim-bounce: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* ==========================================================================
           2. RESETEO Y ESTRUCTURA BASE
           ========================================================================== */
        * { 
            box-sizing: border-box; 
            outline: none;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-void);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            position: relative;
            line-height: 1.5;
        }

        /* ==========================================================================
           3. FONDO ANIMADO PARALLAX (3 CAPAS)
           ========================================================================== */
        .star-field {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; pointer-events: none;
            background: radial-gradient(circle at center, #2a0000 0%, #000000 100%);
            overflow: hidden;
        }

        .stars-1 {
            width: 2px; height: 2px; background: transparent;
            box-shadow: 100px 200px #fff, 400px 500px #fff, 800px 100px #fff, 1200px 900px #fff;
            animation: animStar 100s linear infinite;
        }
        .stars-2 {
            width: 3px; height: 3px; background: transparent;
            box-shadow: 200px 300px #ccc, 500px 100px #ccc, 900px 600px #ccc;
            animation: animStar 50s linear infinite;
        }
        .stars-3 {
            width: 4px; height: 4px; background: transparent;
            box-shadow: 150px 800px #aaa, 600px 200px #aaa;
            animation: animStar 25s linear infinite;
        }

        @keyframes animStar {
            from { transform: translateY(0px); }
            to { transform: translateY(-2000px); }
        }

        ::-webkit-scrollbar { width: 8px; background: transparent; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        ::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.15); border-radius: 4px;
            border: 2px solid transparent; background-clip: content-box;
        }
        ::-webkit-scrollbar-thumb:hover { background-color: rgba(255,255,255,0.4); }

        /* ==========================================================================
           4. BARRA DE NAVEGACION
           ========================================================================== */
        .navbar {
            background: rgba(2, 2, 2, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            height: 70px; 
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 5%;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.4s ease;
        }

        .brand-wrapper {
            display: flex; align-items: center; gap: 10px; text-decoration: none;
            transition: var(--anim-fast);
        }
        .brand-wrapper:hover { transform: translateY(-1px); }

        .brand-icon-img {
            height: 35px; 
            width: auto;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
        }

        .brand-logo {
            font-family: 'Cinzel', serif; 
            font-weight: 700;
            font-size: 1.6rem; 
            letter-spacing: 2px;
            text-transform: uppercase;
            position: relative;
            background: linear-gradient(to right, var(--gold-dark), var(--gold-main), var(--gold-light), var(--gold-main));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .nav-menu {
            display: flex; gap: 30px;
            background: transparent; 
            padding: 0;
            border: none;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            padding: 5px 0;
            transition: color 0.3s;
            font-family: 'Inter', sans-serif;
        }

        .nav-link:hover, .nav-link.active {
            color: white;
            background: transparent; 
            box-shadow: none;
        }

        .nav-link::after {
            content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 1px;
            background: var(--gold-main); 
            transition: width 0.3s var(--anim-smooth);
        }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }

        .header-search { position: relative; width: 280px; }

        .search-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05); 
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            padding: 10px 45px 10px 20px; 
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            transition: var(--anim-smooth);
        }

        .search-input:focus {
            border-color: var(--neon-primary);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 15px rgba(255,26,26,0.1);
            width: 100%;
        }

        .search-btn-icon {
            position: absolute; right: 5px; top: 50%; transform: translateY(-50%);
            width: 32px; height: 32px; 
            background: var(--neon-primary);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: none; cursor: pointer; color: white;
            transition: var(--anim-bounce);
        }
        .search-btn-icon:hover { transform: translateY(-50%) scale(1.1); box-shadow: var(--neon-glow); }

        /* --- SUGERENCIAS DE BUSQUEDA (AUTOSUGGEST) --- */
        .suggestions-box {
            position: absolute;
            top: 110%;
            left: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.8);
            z-index: 2000;
            display: none; 
            animation: fadeInSugg 0.2s ease;
        }
        @keyframes fadeInSugg { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .suggestion-item {
            padding: 12px 20px;
            color: #ddd;
            font-size: 0.9rem;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: background 0.1s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-item:hover, .suggestion-item.selected {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .sugg-icon { width: 16px; height: 16px; opacity: 0.6; fill: currentColor; }
        .sugg-text { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* ==========================================================================
           5. LAYOUT PRINCIPAL (DASHBOARD GRID)
           ========================================================================== */
        .main-container {
            max-width: 1700px;
            margin: 50px auto;
            padding: 0 40px;
            flex: 1;
            width: 100%;
        }

        .dashboard-layout {
            display: grid;
            grid-template-columns: 420px 1fr; /* Sidebar Ancha - Contenido Flexible */
            gap: 50px;
            align-items: start;
            opacity: 0;
            animation: fadeUp 1s var(--anim-smooth) forwards;
        }

        @keyframes fadeUp { 
            from { opacity: 0; transform: translateY(60px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .panel {
            background: var(--glass-surface);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            box-shadow: var(--glass-shadow);
            overflow: hidden;
            transition: var(--anim-smooth);
            position: relative;
        }
        
        .panel::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            border-radius: var(--radius-lg);
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
            pointer-events: none;
        }

        /* ==========================================================================
           6. SIDEBAR IZQUIERDA (PERFIL ARTISTA)
           ========================================================================== */
        .sidebar-profile {
            position: sticky;
            top: 100px; 
            padding: 50px 40px;
            text-align: center;
            display: flex; flex-direction: column; align-items: center;
        }

        /* Avatar con Anillo Animado */
        .avatar-container {
            width: 240px; height: 240px;
            position: relative;
            margin-bottom: 40px;
        }

        .avatar-ring {
            position: absolute; top: -6px; left: -6px; right: -6px; bottom: -6px;
            border-radius: 50%;
            border: 3px solid transparent;
            background: linear-gradient(45deg, var(--neon-primary), transparent, var(--neon-secondary)) border-box;
            
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            
            animation: rotateRing 8s linear infinite;
        }

        .artist-avatar {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 8px solid var(--bg-void);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .avatar-container:hover .artist-avatar { transform: scale(1.08); }

        @keyframes rotateRing { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Titulo Artista */
        .artist-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 900;
            font-size: 2.8rem;
            line-height: 1;
            text-transform: uppercase;
            margin-bottom: 15px;
            background: linear-gradient(180deg, #ffffff, #aaaaaa);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));
        }

        /* Boton Compartir */
        .btn-share {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.1);
            color: white; padding: 8px 20px; border-radius: 20px;
            font-size: 0.8rem; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; gap: 8px; margin-bottom: 30px;
        }
        .btn-share:hover { background: var(--neon-primary); border-color: var(--neon-primary); }

        /* Grid de Estadisticas */
        .stats-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
            width: 100%; margin: 10px 0 30px;
        }

        .stat-box {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .stat-box:hover { background: rgba(255,255,255,0.05); border-color: var(--glass-highlight); transform: translateY(-5px); }

        .stat-number { font-family: 'Montserrat', sans-serif; font-weight: 800; font-size: 1.3rem; color: white; }
        .stat-label { font-size: 0.65rem; text-transform: uppercase; color: var(--text-tertiary); letter-spacing: 1.5px; margin-top: 8px; }

        /* Badges */
        .tags-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .genre-badge {
            background: rgba(255,26,26,0.08); border: 1px solid rgba(255,26,26,0.2);
            color: #ffcccc; padding: 8px 16px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.5px; transition: 0.3s;
        }
        .genre-badge:hover { background: var(--neon-primary); color: white; border-color: var(--neon-primary); }

        /* Indicador de Fuente */
        .source-badge {
            display: inline-flex; align-items: center; gap: 10px;
            padding: 10px 20px; border-radius: 15px;
            font-size: 0.85rem; font-weight: 700; margin-bottom: 25px;
        }
        .src-spotify { background: rgba(29, 185, 84, 0.15); border: 1px solid rgba(29, 185, 84, 0.4); color: #1DB954; }
        .src-lastfm { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: #ffaaaa; }
        .src-emergency { background: rgba(255, 204, 0, 0.15); border: 1px solid rgba(255, 204, 0, 0.4); color: #ffcc00; }

        /* ==========================================================================
           7. PANEL DERECHO (CONTENIDO PRINCIPAL)
           ========================================================================== */
        .content-panel { padding: 50px; min-height: 800px; }

        /* Navegacion de Pestanas */
        .tabs-header {
            display: flex; gap: 30px; margin-bottom: 40px;
            border-bottom: 2px solid rgba(255,255,255,0.05); padding-bottom: 15px;
            overflow-x: auto; 
        }

        .tab-btn {
            background: none; border: none; color: var(--text-tertiary);
            font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 1.2rem;
            text-transform: uppercase; cursor: pointer; padding: 10px 10px;
            position: relative; transition: 0.3s; white-space: nowrap;
        }
        
        .tab-btn:hover { color: white; }
        .tab-btn.active { color: white; }
        .tab-btn.active::after {
            content: ''; position: absolute; bottom: -17px; left: 0; width: 100%; height: 4px;
            background: var(--neon-primary); box-shadow: var(--neon-glow); border-radius: 2px 2px 0 0;
        }

        .tab-content { display: none; opacity: 0; transform: translateY(20px); transition: 0.5s; }
        .tab-content.active { display: block; opacity: 1; transform: translateY(0); animation: tabSlide 0.5s var(--anim-smooth); }
        @keyframes tabSlide { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- PESTANA 1: MUSICA --- */
        .section-headline { font-size: 1.5rem; color: white; margin-bottom: 25px; font-weight: 700; display:flex; align-items:center; gap:10px; }
        
        .tracks-list { display: flex; flex-direction: column; gap: 15px; }

        .track-row {
            display: flex; align-items: center; justify-content: space-between;
            background: rgba(255,255,255,0.02); padding: 20px 30px;
            border-radius: 20px; border: 1px solid transparent;
            transition: var(--anim-fast); cursor: default;
        }
        .track-row:hover {
            background: rgba(255,255,255,0.06); border-color: var(--glass-highlight);
            transform: scale(1.01); box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .track-left { display: flex; align-items: center; gap: 25px; flex: 1; }
        .track-index { font-family: 'Montserrat', sans-serif; font-weight: 900; color: var(--text-tertiary); font-size: 1.2rem; width: 40px; }
        
        .visualizer { display: flex; gap: 3px; align-items: flex-end; height: 20px; width: 20px; display: none; }
        .track-row:hover .visualizer { display: flex; }
        .track-row:hover .track-index { display: none; }
        .v-bar { width: 4px; background: var(--neon-primary); animation: soundWave 0.5s infinite alternate; }
        .v-bar:nth-child(1) { height: 60%; animation-delay: 0.1s; }
        .v-bar:nth-child(2) { height: 30%; animation-delay: 0.2s; }
        .v-bar:nth-child(3) { height: 80%; animation-delay: 0.3s; }
        @keyframes soundWave { 0% { height: 20%; } 100% { height: 100%; } }

        .track-info h4 { font-size: 1.1rem; color: white; margin-bottom: 5px; font-weight: 600; }
        .track-info span { font-size: 0.85rem; color: var(--text-tertiary); }

        .track-actions { display: flex; gap: 12px; }
        .action-btn {
            width: 45px; height: 45px; border-radius: 50%; border: none;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s; color: white;
        }
        .btn-spotify { background: rgba(29, 185, 84, 0.2); color: #1DB954; }
        .btn-spotify:hover { background: #1DB954; color: white; box-shadow: 0 0 20px rgba(29,185,84,0.5); transform: scale(1.1); }
        .btn-youtube { background: rgba(255, 0, 0, 0.2); color: #ff4444; }
        .btn-youtube:hover { background: #ff0000; color: white; box-shadow: 0 0 20px rgba(255,0,0,0.5); transform: scale(1.1); }

        .video-cinema {
            margin-top: 50px; background: #000; padding: 10px;
            border-radius: var(--radius-lg); box-shadow: 0 40px 80px rgba(0,0,0,0.9);
            border: 1px solid rgba(255,255,255,0.15); position: relative;
        }
        .video-label {
            padding: 15px 25px; font-weight: 800; color: #666; text-transform: uppercase;
            font-size: 0.8rem; display: flex; align-items: center; gap: 12px; letter-spacing: 1px;
        }
        .rec-dot { width: 10px; height: 10px; background: red; border-radius: 50%; animation: pulseRed 1.5s infinite; }
        @keyframes pulseRed { 0% { box-shadow: 0 0 0 0 rgba(255,0,0,0.7); } 70% { box-shadow: 0 0 0 10px rgba(255,0,0,0); } 100% { box-shadow: 0 0 0 0 rgba(255,0,0,0); } }

        .video-iframe { width: 100%; height: 450px; border-radius: 20px; border: none; }

        /* --- PESTANA 2: BIOGRAFIA --- */
        .bio-wrapper {
            background: rgba(0,0,0,0.3); padding: 40px;
            border-radius: var(--radius-md); line-height: 1.9;
            font-size: 1.1rem; color: #e0e0e0; text-align: justify;
            max-height: 600px; overflow-y: auto;
            border-left: 5px solid var(--neon-primary);
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
        }
        .bio-wrapper p { margin-bottom: 25px; }
        .bio-wrapper::-webkit-scrollbar { width: 6px; }
        .bio-wrapper::-webkit-scrollbar-thumb { background: var(--neon-secondary); border-radius: 3px; }

        /* --- PESTANA 3: DISCOGRAFIA --- */
        .albums-grid-system {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 35px;
        }
        .album-item { text-align: center; transition: 0.3s; cursor: pointer; perspective: 1000px; }
        .album-item:hover { transform: translateY(-15px); }

        .album-art {
            width: 100%; aspect-ratio: 1/1; border-radius: 20px; object-fit: cover;
            box-shadow: 0 15px 30px rgba(0,0,0,0.6); margin-bottom: 15px;
            border: 3px solid transparent; transition: 0.4s;
        }
        .album-item:hover .album-art {
            border-color: var(--neon-primary); box-shadow: 0 0 30px rgba(255, 26, 26, 0.3);
            transform: rotateX(5deg);
        }
        .album-name { font-weight: 700; font-size: 1rem; line-height: 1.3; color: white; margin-bottom: 6px; }
        .album-year { color: var(--text-tertiary); font-size: 0.85rem; font-family: 'Montserrat', sans-serif; }

        /* ==========================================================================
           8. PANTALLA DE INICIO (HERO)
           ========================================================================== */
        .hero-section {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 75vh; text-align: center; animation: heroFade 1.2s ease;
        }
        @keyframes heroFade { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        .hero-logo {
            font-family: 'Cinzel', serif;
            font-size: 6rem; 
            font-weight: 700;
            letter-spacing: 2px;
            margin: 0;
            background: linear-gradient(to right, var(--gold-dark), var(--gold-main), var(--gold-light), var(--gold-main));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            text-shadow: 0 5px 25px rgba(0,0,0,0.5); 
        }

        .hero-tagline {
            font-size: 1.8rem; color: var(--neon-primary); margin: 25px 0;
            text-transform: uppercase; letter-spacing: 8px; font-weight: 700;
            animation: neonPulse 3s infinite alternate;
        }
        @keyframes neonPulse { from { text-shadow: 0 0 15px rgba(255,26,26,0.3); } to { text-shadow: 0 0 30px rgba(255,26,26,0.8); } }

        .hero-desc { max-width: 700px; margin: 20px auto; color: #999; font-size: 1.2rem; line-height: 1.7; }

        .hero-stats {
            display: flex; gap: 60px; margin-top: 70px; opacity: 0.6;
        }
        .h-stat { display: flex; flex-direction: column; gap: 10px; align-items: center; }
        .h-stat svg { width: 40px; height: 40px; fill: white; }
        .h-stat span { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; }

        /* ==========================================================================
           9. COMPONENTES FLOTANTES Y FOOTER
           ========================================================================== */
        .alert-float {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: rgba(255, 50, 50, 0.15); border: 1px solid var(--state-error);
            padding: 18px 40px; border-radius: 50px; color: #ffcccc; font-weight: 600;
            display: flex; align-items: center; gap: 15px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.7); backdrop-filter: blur(15px);
            z-index: 2000; animation: slideUpFade 0.6s ease;
        }
        @keyframes slideUpFade { from { bottom: 0; opacity: 0; } to { bottom: 40px; opacity: 1; } }

        .backup-alert {
            background: rgba(255, 204, 0, 0.1); border: 1px solid var(--state-warning);
            color: var(--state-warning); padding: 18px; border-radius: var(--radius-md);
            margin-bottom: 40px; text-align: center; font-weight: 600; letter-spacing: 0.5px;
        }

        .footer {
            border-top: 1px solid var(--glass-border); padding: 60px 20px;
            text-align: center; color: #666; font-size: 0.9rem;
            background: rgba(0,0,0,0.9); margin-top: auto;
        }

        /* Modal de Compartir */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            z-index: 5000; display: none; align-items: center; justify-content: center;
            opacity: 0; transition: 0.3s;
        }
        .modal-overlay.open { display: flex; opacity: 1; }
        
        .modal-box {
            background: var(--glass-surface); border: 1px solid var(--glass-border);
            padding: 40px; border-radius: var(--radius-lg); text-align: center;
            width: 400px; transform: scale(0.8); transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.open .modal-box { transform: scale(1); }
        
        .modal-title { color: white; margin-bottom: 20px; font-family: 'Montserrat', sans-serif; }
        .share-input {
            width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid #444;
            color: white; border-radius: 10px; margin-bottom: 20px;
        }
        .modal-close {
            background: var(--neon-primary); border: none; color: white;
            padding: 10px 30px; border-radius: 30px; cursor: pointer; font-weight: bold;
        }

        /* ==========================================================================
           10. RESPONSIVIDAD MOVIL (ADAPTIVE SYSTEM)
           ========================================================================== */
        @media (max-width: 1200px) {
            .dashboard-layout { grid-template-columns: 1fr; }
            .sidebar-profile { position: relative; top: 0; padding: 30px; margin-bottom: 30px; border-bottom: 1px solid var(--glass-border); }
            .navbar { flex-direction: column; height: auto; padding: 15px 5%; gap: 15px; }
            .header-search { width: 100%; }
            .nav-menu { width: 100%; justify-content: center; overflow-x: auto; padding-bottom: 10px; }
            .hero-title { font-size: 4rem; }
            .hero-stats { gap: 30px; }
        }

        @media (max-width: 768px) {
            .navbar { padding: 15px 20px; }
            .brand-wrapper { margin-bottom: 10px; }
            .brand-logo { font-size: 1.4rem; }
            .nav-link { font-size: 0.75rem; letter-spacing: 1px; }
            
            .main-container { padding: 0 15px; margin-top: 20px; }
            
            /* Content Panel ultra-compacto */
            .content-panel { padding: 15px; }

            .hero-logo { font-size: 3.5rem; }
            .hero-tagline { font-size: 1.2rem; letter-spacing: 4px; }
            .hero-stats { flex-wrap: wrap; justify-content: center; gap: 40px; }
            
            /* --- TRACKS ULTRA COMPACTOS --- */
            .track-row { 
                flex-direction: row; /* Fila horizontal */
                align-items: center; 
                gap: 10px; 
                padding: 10px 15px;
                min-height: auto; 
            }
            
            .track-left { 
                width: auto; 
                flex: 1; 
                min-width: 0; /* Permitir truncamiento */
            }
            
            .track-index { 
                font-size: 1rem; 
                width: 25px; 
                min-width: 25px; 
            }
            
            .track-info h4 { 
                font-size: 0.95rem; 
                margin-bottom: 2px;
                white-space: nowrap; 
                overflow: hidden; 
                text-overflow: ellipsis; 
            }
            
            .track-info span { 
                font-size: 0.7rem; 
            }
            
            .track-actions { 
                width: auto; 
                justify-content: flex-end; 
                margin-top: 0; 
                gap: 8px;
            }
            
            .action-btn { 
                width: 32px; 
                height: 32px; 
            }
            
            .action-btn svg { 
                width: 16px; 
                height: 16px; 
            }
            
            /* --- TABS COMPACTAS --- */
            .tabs-header { 
                gap: 15px; 
                justify-content: space-between; 
                padding-bottom: 10px; 
            }
            .tab-btn { 
                font-size: 0.9rem; 
                padding: 5px; 
            }
            
            .video-iframe { height: 200px; }
            .albums-grid-system { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
            
            .modal-box { width: 90%; padding: 30px 20px; }

            /* --- AJUSTES DE PERFIL EN MOVIL (COMPACTO) --- */
            .sidebar-profile { 
                padding: 20px 15px; 
            }
            
            .avatar-container { 
                width: 140px; height: 140px; 
                margin-bottom: 15px; 
            }
            
            .artist-title { 
                font-size: 1.8rem; 
                margin-bottom: 8px;
            }
            
            .btn-share { margin-bottom: 20px; padding: 6px 16px; font-size: 0.75rem; }

            .stats-grid { 
                gap: 8px; 
                margin-bottom: 15px;
            }
            
            .stat-box { padding: 12px; }
            .stat-number { font-size: 1rem; }
            .stat-label { font-size: 0.6rem; letter-spacing: 1px; }
            
            .genre-badge { font-size: 0.6rem; padding: 5px 10px; }
            .source-badge { font-size: 0.75rem; padding: 8px 16px; margin-bottom: 20px; }
        }

        /* --- NUEVO: AJUSTES PARA PANTALLAS MUY PEQUEÑAS (Mobile XS) --- */
        @media (max-width: 480px) {
            .navbar { padding: 10px; }
            .brand-logo { font-size: 1.2rem; }
            .header-search input { padding: 8px 35px 8px 15px; font-size: 0.8rem; }
            
            .sidebar-profile { padding: 15px 10px; }
            .avatar-container { width: 120px; height: 120px; margin-bottom: 10px; }
            .artist-title { font-size: 1.5rem; }
            
            .track-row { padding: 8px 10px; gap: 8px; }
            .track-index { font-size: 0.8rem; width: 20px; min-width: 20px; }
            .track-info h4 { font-size: 0.85rem; }
            .track-info span { font-size: 0.65rem; }
            
            .action-btn { width: 28px; height: 28px; }
            .action-btn svg { width: 14px; height: 14px; }
            
            .tab-btn { font-size: 0.75rem; padding: 5px 2px; }
            
            .albums-grid-system { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .album-name { font-size: 0.85rem; }
            .album-year { font-size: 0.75rem; }
        }
    </style>
</head>
<body>

    <div class="star-field">
        <div class="stars-1"></div>
        <div class="stars-2"></div>
        <div class="stars-3"></div>
    </div>

    {% set placeholder = placeholder_global if placeholder_global is defined else 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png' %}

    <nav class="navbar">
        <a href="/" class="brand-wrapper">
            <img src="{{ url_for('static', filename='golden-feather.png') }}" alt="Legatum Gold Icon" class="brand-icon-img">
            <div class="brand-logo">LEGATUM</div>
        </a>

        <div class="nav-menu">
            <a href="/" class="nav-link active">Inicio</a>
            <a href="/artistas" class="nav-link">Descubrir</a>
            <a href="/generos" class="nav-link">Generos</a>
        </div>

        <form class="header-search" method="POST" action="/" id="searchForm">
            <input type="text" name="artista" id="searchInput" class="search-input" placeholder="Busca tu sonido..." autocomplete="off" required>
            <button type="submit" class="search-btn-icon">
                <svg style="width:20px;height:20px;fill:white" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,9.5C14,7 12,5 9.5,5Z" /></svg>
            </button>
            
            <!-- CONTENEDOR DE SUGERENCIAS (AUTOSUGGEST) -->
            <div id="searchSuggestions" class="suggestions-box"></div>
        </form>
    </nav>

    {% if error %}
        <div class="alert-float">
            <svg style="width:28px;height:28px" viewBox="0 0 24 24"><path fill="currentColor" d="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z" /></svg>
            <span>{{ error }}</span>
        </div>
    {% endif %}

    <div class="main-container">
        
        {% if datos %}
            
            {% if datos.modo_respaldo %}
                <div class="backup-alert">
                    ⚠️ ATENCION: Modo de Resiliencia Activado. Conexion con API primaria inestable, sirviendo datos de respaldo seguros.
                </div>
            {% endif %}

            <div class="dashboard-layout">
                
                <aside class="panel sidebar-profile">
                    
                    {% if datos.fuente == 'Spotify' %}
                        <div class="source-badge src-spotify">
                            <svg style="width:16px;height:16px;fill:currentColor" viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.46-1.02 15.66 1.44.539.3.719.96.42 1.5-.239.479-.899.66-1.44.36z"/></svg>
                            Spotify Verified
                        </div>
                    {% elif datos.fuente == 'Last.fm' %}
                        <div class="source-badge src-lastfm">Last.fm Data Source</div>
                    {% else %}
                        <div class="source-badge src-emergency">Web Scraping Result</div>
                    {% endif %}

                    <div class="avatar-container">
                        <div class="avatar-ring"></div>
                        {% if datos.info.images and datos.info.images|length > 0 %}
                            <img src="{{ datos.info.images[0].url }}" class="artist-avatar" alt="{{ datos.info.name }}" onerror="this.src='{{ placeholder }}'">
                        {% else %}
                            <img src="{{ placeholder }}" class="artist-avatar" alt="Sin Imagen">
                        {% endif %}
                    </div>

                    <h1 class="artist-title">{{ datos.info.name }}</h1>

                    <button class="btn-share" onclick="openShareModal()">
                        <svg style="width:16px;height:16px;fill:currentColor" viewBox="0 0 24 24"><path d="M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.13C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.87C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.13L15.16,18.3C15.11,18.53 15.08,18.76 15.08,19A3,3 0 0,0 18,22A3,3 0 0,0 21,19A3,3 0 0,0 18,16.08Z" /></svg>
                        Compartir Perfil
                    </button>

                    <div class="stats-grid">
                        <div class="stat-box">
                            <span class="stat-number">{{ "{:,}".format(datos.info.followers.total|int) if datos.info.followers.total != 'N/A' else 'N/A' }}</span>
                            <span class="stat-label">Seguidores</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" style="color:var(--neon-primary)">{{ datos.info.popularity }}</span>
                            <span class="stat-label">Popularidad</span>
                        </div>
                    </div>

                    <div class="tags-container">
                        {% if datos.info.genres %}
                            {% for genero in datos.info.genres %}
                                <span class="genre-badge">{{ genero }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="genre-badge">Artista General</span>
                        {% endif %}
                    </div>

                </aside>

                <main class="panel content-panel">
                    
                    <div class="tabs-header">
                        <button class="tab-btn active" onclick="openTab(event, 'tab-music')">Musica</button>
                        <button class="tab-btn" onclick="openTab(event, 'tab-bio')">Biografia</button>
                        <button class="tab-btn" onclick="openTab(event, 'tab-albums')">Discografia</button>
                    </div>

                    <div id="tab-music" class="tab-content active">
                        <div class="section-headline">
                            <svg style="width:24px;height:24px;fill:var(--neon-primary)" viewBox="0 0 24 24"><path d="M16,9H13V14.5A2.5,2.5 0 0,1 10.5,17A2.5,2.5 0 0,1 8,14.5A2.5,2.5 0 0,1 10.5,12C11.07,12 11.58,12.19 12,12.5V7H16M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z" /></svg>
                            Top Canciones
                        </div>
                        
                        <div class="tracks-list">
                            {% if datos.tracks %}
                                {% for track in datos.tracks %}
                                <div class="track-row">
                                    <div class="track-left">
                                        <div class="track-index">{{ loop.index }}</div>
                                        <div class="visualizer"><div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div></div>
                                        <div class="track-info">
                                            <h4>{{ track.name }}</h4>
                                            <span>Top Hit • Verificado</span>
                                        </div>
                                    </div>
                                    <div class="track-actions">
                                        {% if track.external_urls and track.external_urls.spotify %}
                                        <a href="{{ track.external_urls.spotify }}" target="_blank" class="action-btn btn-spotify" title="Escuchar en Spotify">
                                            <svg style="width:20px;height:20px;fill:currentColor" viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.46-1.02 15.66 1.44.539.3.719.96.42 1.5-.239.479-.899.66-1.44.36z"/></svg>
                                        </a>
                                        {% endif %}
                                        <a href="https://www.youtube.com/results?search_query={{ datos.info.name }} {{ track.name }} official audio" target="_blank" class="action-btn btn-youtube" title="Ver en YouTube">
                                            <svg style="width:20px;height:20px;fill:currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                                        </a>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <p style="color:#777; text-align:center;">No hay tracks disponibles.</p>
                            {% endif %}
                        </div>

                        {% if video_id %}
                        <div class="video-cinema">
                            <div class="video-label">
                                <div class="rec-dot"></div>
                                Reproduciendo Video Destacado
                            </div>
                            <iframe src="https://www.youtube.com/embed/{{ video_id }}" class="video-iframe" allowfullscreen></iframe>
                        </div>
                        {% endif %}
                    </div>

                    <div id="tab-bio" class="tab-content">
                        <h2 style="color: white; margin-bottom: 20px;">Historia del Artista</h2>
                        <div class="bio-wrapper">
                            <p>{{ bio if bio else "No hay informacion biografica disponible." }}</p>
                        </div>
                    </div>

                    <div id="tab-albums" class="tab-content">
                        <h2 style="color: white; margin-bottom: 20px;">Discografia Esencial</h2>
                        {% if datos.albums %}
                        <div class="albums-grid-system">
                            {% for album in datos.albums %}
                            <div class="album-item">
                                {% if album.images and album.images|length > 0 %}
                                    <img src="{{ album.images[0].url }}" class="album-art" alt="{{ album.name }}" onerror="this.src='{{ placeholder }}'">
                                {% else %}
                                    <img src="{{ placeholder }}" class="album-art" alt="Cover no disponible">
                                {% endif %}
                                <div class="album-name">{{ album.name }}</div>
                                {% if album.release_date %}
                                    <div class="album-year">{{ album.release_date[:4] }}</div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                            <p style="color:#777; text-align:center;">No hay albumes disponibles.</p>
                        {% endif %}
                    </div>

                </main>
            </div>

        {% else %}
            
            <div class="hero-section">
                <h1 class="hero-logo">LEGATUM</h1>
                <div class="hero-tagline">Donde el sonido se convierte en legado</div>
                <p class="hero-desc">
                    Conecta todas tus fuentes musicales en una interfaz unificada.
                    <br>Busqueda Inteligente • Datos Verificados • Streaming Visual
                </p>
                
                <div class="hero-stats">
                    <div class="h-stat">
                        <svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M16.18,7.76L15.12,8.82L14.06,7.76L13,8.82L14.06,9.88L13,10.94L14.06,12L15.12,10.94L16.18,12L17.24,10.94L16.18,9.88L17.24,8.82L16.18,7.76M7.82,12L8.88,10.94L9.94,12L11,10.94L9.94,9.88L11,8.82L9.94,7.76L8.88,8.82L7.82,7.76L6.76,8.82L7.82,9.88L6.76,10.94L7.82,12Z"/></svg>
                        <span>Discover</span>
                    </div>
                    <div class="h-stat">
                        <svg viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.46-1.02 15.66 1.44.539.3.719.96.42 1.5-.239.479-.899.66-1.44.36z"/></svg>
                        <span>Connect</span>
                    </div>
                    <div class="h-stat">
                        <svg viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                        <span>Play</span>
                    </div>
                </div>
            </div>

        {% endif %}

    </div>

    <div class="modal-overlay" id="shareModal" onclick="closeShareModal(event)">
        <div class="modal-box" onclick="event.stopPropagation()">
            <h2 class="modal-title">Compartir Perfil</h2>
            <p style="color:#aaa; margin-bottom:20px;">Copia este enlace para compartir este artista:</p>
            <input type="text" class="share-input" value="https://legatum-music.com/artist/{{ datos.info.name if datos else '' }}" readonly>
            <button class="modal-close" onclick="closeShareModal()">Cerrar</button>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Legatum Music System. Enterprise Edition v12.0</p>
        <p style="opacity:0.5; margin-top:5px; font-size:0.75rem;">
            Construido con Python Flask • Spotify API • Last.fm • YouTube Data API
        </p>
    </footer>

    <script>
        // 1. Sistema de Pestanas (Tabs)
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab-btn");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            setTimeout(() => {
                document.getElementById(tabName).classList.add("active");
            }, 10);
            evt.currentTarget.className += " active";
        }

        // 2. Modal de Compartir
        function openShareModal() {
            document.getElementById('shareModal').classList.add('open');
        }
        
        function closeShareModal(e) {
            if (!e || e.target.id === 'shareModal' || e.target.classList.contains('modal-close')) {
                document.getElementById('shareModal').classList.remove('open');
            }
        }
        
        // 3. Desplazamiento Suave al Perfil
        document.addEventListener('DOMContentLoaded', () => {
            const dashboard = document.querySelector('.dashboard-layout');
            if (dashboard) {
                dashboard.scrollIntoView({ behavior: 'smooth' });
            }
        });

        // 4. AUTOSUGGEST LOGIC (Estilo YouTube)
        const searchInput = document.getElementById('searchInput');
        const suggestionsBox = document.getElementById('searchSuggestions');
        let debounceTimer;
        let currentFocus = -1;

        searchInput.addEventListener('input', function(e) {
            const val = this.value;
            clearTimeout(debounceTimer);
            
            if (!val || val.length < 2) {
                suggestionsBox.style.display = 'none';
                return;
            }

            debounceTimer = setTimeout(() => {
                fetch(`/autosuggest?q=${encodeURIComponent(val)}`)
                    .then(response => response.json())
                    .then(data => {
                        suggestionsBox.innerHTML = '';
                        currentFocus = -1;
                        
                        if (data.length > 0) {
                            data.forEach(item => {
                                const div = document.createElement('div');
                                div.className = 'suggestion-item';
                                
                                // Icono segun tipo
                                let icon = '';
                                if(item.type === 'artist') {
                                    icon = '<svg class="sugg-icon" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>';
                                } else {
                                    icon = '<svg class="sugg-icon" viewBox="0 0 24 24"><path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/></svg>';
                                }
                                
                                div.innerHTML = `${icon} <span class="sugg-text">${item.text}</span>`;
                                
                                div.addEventListener('click', function() {
                                    searchInput.value = item.text;
                                    suggestionsBox.style.display = 'none';
                                    document.getElementById('searchForm').submit();
                                });
                                
                                suggestionsBox.appendChild(div);
                            });
                            suggestionsBox.style.display = 'block';
                        } else {
                            suggestionsBox.style.display = 'none';
                        }
                    })
                    .catch(err => console.error("Error en autosuggest", err));
            }, 300); // 300ms debounce
        });

        // Navegacion con teclado (Flechas)
        searchInput.addEventListener('keydown', function(e) {
            const items = suggestionsBox.getElementsByClassName('suggestion-item');
            if (e.key === 'ArrowDown') {
                currentFocus++;
                addActive(items);
            } else if (e.key === 'ArrowUp') {
                currentFocus--;
                addActive(items);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (currentFocus > -1 && items) {
                    items[currentFocus].click();
                } else {
                    document.getElementById('searchForm').submit(); // Submit normal
                }
            }
        });

        function addActive(items) {
            if (!items) return false;
            removeActive(items);
            if (currentFocus >= items.length) currentFocus = 0;
            if (currentFocus < 0) currentFocus = (items.length - 1);
            items[currentFocus].classList.add('selected');
            // Auto scroll en la lista si es necesario (opcional)
        }

        function removeActive(items) {
            for (let i = 0; i < items.length; i++) {
                items[i].classList.remove('selected');
            }
        }

        // Cerrar al hacer clic fuera
        document.addEventListener('click', function(e) {
            if (e.target !== searchInput && e.target !== suggestionsBox) {
                suggestionsBox.style.display = 'none';
            }
        });
    </script>

</body>
</html>